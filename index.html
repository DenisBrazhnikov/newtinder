<html>  
    <head>

    </head>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fuzzy+Bubbles&display=swap" rel="stylesheet">
    <style>
        .parent {
            position: relative;
            perspective: 2000px;
        }

        .card {  
            font-family: 'Fuzzy Bubbles', cursive;
            font-size: 15px;
            width: 100px;
            height: 100px;
            padding: 20px;
            position: absolute;
            border: 1px solid #ececec;
            background-color: burlywood;
            
            
            display: none;
            transform-origin: 0 0;
            transition: transform .1s ease-in-out;
        }

        #first {
            transform: rotateY(0deg);
            color: white;
            text-align: right;
            z-index: 1;
            left: 10px;
            top: 10px;
            display: block;
        }

        #second {
            transform: rotateY(180deg);
            text-align: left;
            z-index: 2;
            left: 150px;
            top: 10px;
        }

        #third {
            transform: rotateX(360deg);
            text-align: center;
            z-index: 3;
            width: 240px;
            left: 10px;
            top: 150px;
        }
    </style>
    <body>
        <div class="parent">
            <div class="card" id="first">I'd like to erewreretreg  trter tretretv</div>
            <div class="card" id="second">that you te tret rtretre trtrtare</div>
            <div class="card" id="third">t ert re tre tret rrew twr treter tre te y tr ytytyty rtytry rt ytryty tr  e tret tr</div>
          </div> 
    </body>

    <script>
    document.addEventListener('touchstart', handleTouchStart, false);
    document.addEventListener('touchmove', handleTouchMove, false);
    document.addEventListener('touchend', handleTouchEnd, false);
        const STATE_FIRST = 0;
        const STATE_SECOND = 1;
        const STATE_THIRD = 2;

        const DEGRESS_MAX = 0;
        const DEGRESS_MIN = -180;
        const DEGRESS_THRESHOLD = -90;

        var cardState = STATE_FIRST;
        let degress = 0;

        var rightCard = document.getElementById("first");

        var startX;
        var startY;

        function clamp(value, min, max) {
            return Math.max(min, Math.min(max, value))
        }

        function handleTouchStart(event) {
            const firstTouch = event.touches[0];
             startX = firstTouch.clientX; 
             startY = firstTouch.clientY;
             console.log('handleTouchStart', startX, startY); 
        }

        function handleTouchEnd(event) {
            if (cardState < STATE_THIRD && degress > DEGRESS_THRESHOLD) {
                setState(cardState + 1);
            }
        }

        function handleTouchMove(event) {
            const cardWidth = rightCard.offsetWidth;
            let axis;
            let diff;
            let elementId;

            switch (cardState) {
                case STATE_FIRST:
                    diff = startX - event.touches[0].clientX;
                    axis = 'y';
                    elementId = 'second';
                    break;
                case STATE_SECOND:
                    diff = startY - event.touches[0].clientY;
                    axis = 'x';
                    elementId = 'third';
                    break;
                default:
                    return;
            }

            degress = clamp(180 - Math.floor(-diff * 180 / (cardWidth * 2)), 0, 180);

            console.log(diff, degress);
            // super smoooooth
            setDegress(elementId, degress, axis);
        }

        function setDegress(elementId, degress, axis, displayText = false) {
            let element = document.getElementById(elementId);
            let axisX = axis == 'x' ? 1 : 0;
            let axisY = axis == 'y' ? 1 : 0;
            let axisZ = axis == 'z' ? 1 : 0;
            if (!element) {
                throw new `Element not found: #${elementId}`;
            }

            if(displayText || degress < 95) {
                element.style.color = 'white';
                //element.style.opacity = 1;
            }

            //element.style.opacity = 1 - degress / 180;
            console.log( 1.5 -  degress / 180);
            
            element.style.transform = `rotate3d(${axisX}, ${axisY}, ${axisZ} , ${degress}deg)`;
            element.style.display = 'block';
        }

        function setState(newState) {
            console.trace();
            switch (newState) {
                case STATE_FIRST:
                    //setDegress('right', DEGRESS_MIN, 'y');
                    //setDegress('bottom', DEGRESS_MIN, 'x');
                    break;
                case STATE_SECOND:
                    setDegress('second', 0, 'y', true);
                    break;
                case STATE_THIRD:
                    setDegress('third', 0, 'x', true);
                    break;
            }
            cardState = newState;
        }

    </script>
</html>